<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <h3 class="page-title">–ù–æ–≤–∞—è –ø–æ—Å—Ç–∞–≤–∫–∞</h3>
            <h6 class="page-title-second-text">
                –ü–æ—Å—Ç–∞–≤–∫–∞ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ –∏ —Ç–æ–≤–∞—Ä–æ–≤
                <span style="font-size: 20px"> üöö</span>
            </h6>
        </div>
    </div>
    <hr>
    <app-page-loader [show]="loader"></app-page-loader>
    <form [formGroup]="createForm" (ngSubmit)="onSubmit()" *ngIf="!loader">
        <div class="row">
            <div class="col-md-9 col-sm-12">
                <div class="card shadow p-3 ml-2 mb-4" —Ålass="form50">
                    <label class="mt-3">–ü–æ—Å—Ç–∞–≤—â–∏–∫</label>
                    <select class="form-control w-50" formControlName="supplier">
                        <option [ngValue]="null">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞</option>
                        <option [value]="supplier.id" *ngFor="let supplier of suppliers">{{supplier.name}}</option>
                    </select>
                    <small class="invalid" *ngIf="submitted && createForm.get('supplier').invalid">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞</small>

                    <label class="mt-3">–°—á–µ—Ç –¥–ª—è —Å–ø–∏—Å–∞–Ω–∏—è —Å—Ä–µ–¥—Å—Ç–≤</label>
                    <select class="form-control w-50" formControlName="account">
                        <option [ngValue]="null">–í—ã–±–µ—Ä–∏—Ç–µ —Å—á–µ—Ç</option>
                        <option [value]="account.id" *ngFor="let account of accounts">{{account.title}}</option>
                    </select>
                    <small class="invalid" *ngIf="submitted && createForm.get('account').invalid">–í—ã–±–µ—Ä–∏—Ç–µ —Å—á–µ—Ç</small>

                    <label class="mt-3">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
                    <textarea formControlName="comment" cols="20" rows="5" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –ø–æ—Å—Ç–∞–≤–∫–µ"
                        class="form-control w-50"></textarea>

                    <div class="ingredients-container mt-3 p-3">
                        
                        <table mdbTable bordered="true" striped="true" class="ing-table">
                            <thead>
                              <tr>
                                <th scope="col" style="width: 25%">–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç</th>
                                <th scope="col" style="width: 13%">–§–∞—Å–æ–≤–∫–∞</th>
                                <th scope="col" style="width: 18%">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                                <th scope="col" style="width: 6%"></th>
                                <th scope="col" style="width: 15%">–¶–µ–Ω–∞ –∑–∞ –µ–¥.</th>
                                <th scope="col" style="width: 6%"></th>
                                <th scope="col" style="width: 15%">–í—Å–µ–≥–æ</th>
                                <th></th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr *ngIf="!deliveryRows.length">
                                  <td colspan="8" style="text-align: center"><span>–î–æ–±–∞–≤—å—Ç–µ –ø–æ—Å—Ç–∞–≤–∫—É</span></td>
                              </tr>
                              <tr mdbTableCol *ngFor="let item of deliveryRows; let i = index">
                                <td>
                                    <select class="form-control" [ngModelOptions]="{standalone: true}" 
                                        [(ngModel)]="item.ingredientId" (change)="onSelectIngredient(item)">
                                        <option [ngValue]="null">–í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç</option>
                                        <option *ngFor="let ing of ingredients | ingredientsFilter:selectedIngredients:item.ingredientId" 
                                            [value]="ing.id">{{ing.title}}</option>
                                    </select>
                                </td>
                                <td>{{item.unit ? item.unit : '-'}}</td>
                                <td>
                                    <input type="number" min="0" class="form-control" [ngModelOptions]="{standalone: true}"
                                        [(ngModel)]="item.quantity" placeholder="–ö–æ–ª-–≤–æ" (input)="onChangePriceOrQuantity($event, i, false)">
                                </td>
                                <td class="icon-cell"><i class="fas fa-times"></i></td>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <span class="mr-2">‚Ç¥</span>
                                        <input type="number" min="0" step=".01" class="form-control" [ngModelOptions]="{standalone: true}"
                                            [(ngModel)]="item.price" placeholder="–¶–µ–Ω–∞" (input)="onChangePriceOrQuantity($event, i)">
                                    </div>
                                </td>
                                <td class="icon-cell"><i class="fas fa-equals"></i></td>
                                <td style="text-align: center">
                                    <div class="d-flex align-items-center">
                                        <span class="mr-2">‚Ç¥</span>
                                        <input type="number" min="0" step=".01" class="form-control" [ngModelOptions]="{standalone: true}"
                                            [(ngModel)]="item.sum" placeholder="–°—É–º–º–∞" (input)="onChangeSum($event, i)">
                                    </div>
                                </td>
                                <td><span class="material-icons-outlined remove-delivery-btn" (click)="removeDeliveryItem(i)"
                                    title="–û—Ç–º–µ–Ω–∏—Ç—å —ç—Ç—É –ø–æ—Å—Ç–∞–≤–∫—É">cancel_presentation</span></td>
                              </tr>
                            </tbody>
                        </table>
                        <small class="invalid" *ngIf="submitted && !deliveriesIsValid">–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –Ω–µ –≤–µ—Ä–Ω–æ</small>
                        <small class="invalid" *ngIf="submitted && !deliveryRows.length">–ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –ø–æ—Å—Ç–∞–≤–∫—É</small>
                    </div>
                    <div class="d-flex justify-content-between">
                        <button mdbBtn size="sm" style="width: 20%" color="primary" type="button" 
                            class="ml-3" (click)="addDeliveryItem()">
                            <div class="btn-content">
                                <span class="material-icons-outlined icon">add</span> –î–æ–±–∞–≤–∏—Ç—å –µ—â–µ
                            </div>
                        </button>

                        <div *ngIf="deliveryRows.length" class="mr-3">
                            <label class="mt-2"><b>–ò—Ç–æ–≥–æ:</b></label>
                            <span class="ml-2">‚Ç¥ {{totalSum}}</span>
                        </div>
                    </div>

                    <div class="d-flex justify-content-center">
                        <button type="submit" mdbBtn color="success" class="mt-4" style="width: 35%" size="md">
                            –û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ—Å—Ç–∞–≤–∫—É
                        </button>
                    </div>

                </div>
            </div>
        </div>
    </form>
</div>